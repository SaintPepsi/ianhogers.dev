---
interface Props {
  title: string;
  description?: string;
  side?: 'dev' | 'personal' | 'neutral';
}

const { title, description = 'Ian Hogers gets stuff DONE.', side = 'neutral' } = Astro.props;
const sideClass = `side-${side}`;
const currentPath = Astro.url.pathname;
---

<!doctype html>
<html lang="en" class={sideClass}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <link rel="icon" href="/favicon.svg" />
    <link rel="alternate" type="application/rss+xml" title="Ian Hogers - Dev" href="/dev/rss.xml" />
    <link rel="alternate" type="application/rss+xml" title="Ian Hogers - Personal" href="/personal/rss.xml" />
    <title>{title}</title>
  </head>
  <body class="min-h-screen flex flex-col">
    <!-- âœ¦ Marquee ticker -->
    <div class="overflow-hidden bg-surface/60 border-b border-gray-800/50 py-1">
      <div class="flex whitespace-nowrap marquee-track" style="width: max-content;">
        {Array(4).fill(null).map(() => (
          <span class="text-xs font-mono text-gray-600 mx-4">
            âœ¦ welcome to ian's corner of the internet âœ¦ software engineer âœ¦ game dev âœ¦ bunny rescuer âœ¦ dutch-australian âœ¦ gets stuff DONE âœ¦
          </span>
        ))}
      </div>
    </div>

    <!-- âœ¦ Header -->
    <nav class="max-w-3xl mx-auto w-full px-4 sm:px-6 py-4 sm:py-5">
      <div class="flex items-center justify-between">
        <a href="/" class="no-underline hover:opacity-80 flex items-center gap-2 sm:gap-3">
          <span class="star-sprite w-5 h-5 sm:w-6 sm:h-6 animate-sparkle" aria-hidden="true"></span>
          <span class="font-display text-xl sm:text-2xl text-white tracking-wide">Ian Hogers</span>
        </a>
        <div class="flex items-center gap-2 sm:gap-4 text-sm font-mono">
          <!-- Nav links: hidden on mobile, shown on sm+ -->
          <a href="/about" class:list={["no-underline text-xs sm:text-sm hidden sm:inline", currentPath.startsWith('/about') ? 'accent-text' : 'text-gray-400 accent-text-hover']}>about</a>
          <a href="/shoutouts" class:list={["no-underline text-xs sm:text-sm hidden sm:inline", currentPath.startsWith('/shoutouts') ? 'accent-text' : 'text-gray-400 accent-text-hover']}>shouts</a>
          <!-- Side toggle pill -->
          <div class="side-toggle flex items-center gap-0 rounded-full border-2 border-gray-700 transition-all p-0.5">
            <a
              href="/personal"
              class:list={[
                "no-underline inline-flex items-center justify-center w-8 h-8 sm:w-9 sm:h-9 rounded-full text-sm transition-all hover:opacity-80",
                side === 'personal' ? 'bg-amber-500/25 text-amber-400 shadow-inner' : 'text-gray-500'
              ]}
              title="Personal side"
            >ðŸ˜Š</a>
            <a
              href="/dev"
              class:list={[
                "no-underline inline-flex items-center justify-center w-8 h-8 sm:w-9 sm:h-9 rounded-full text-xs font-bold transition-all hover:opacity-80",
                side === 'dev' ? 'bg-purple-500/25 text-purple-300 shadow-inner' : 'text-gray-500'
              ]}
              title="Dev side"
            >&lt;/&gt;</a>
          </div>
        </div>
      </div>
      <!-- Mobile nav links -->
      <div class="flex sm:hidden justify-center gap-4 mt-2 text-sm font-mono">
        <a href="/about" class:list={["no-underline text-xs", currentPath.startsWith('/about') ? 'accent-text' : 'text-gray-400 accent-text-hover']}>about</a>
        <a href="/shoutouts" class:list={["no-underline text-xs", currentPath.startsWith('/shoutouts') ? 'accent-text' : 'text-gray-400 accent-text-hover']}>shouts</a>
      </div>
    </nav>

    <!-- âœ¦ Content -->
    <main class="max-w-3xl mx-auto w-full px-4 sm:px-6 py-4 sm:py-6 flex-1">
      <slot />
    </main>

    <!-- âœ¦ Footer -->
    <footer class="max-w-3xl mx-auto w-full px-4 sm:px-6 py-8">
      <div class="pixel-divider mb-6" style="--divider-color: #2a2438;"></div>
      <div class="flex flex-col sm:flex-row items-center justify-between gap-4 text-sm text-gray-600 font-mono">
        <div class="flex items-center gap-2">
          <img src="/assets/pixel-art/decorative/sample-bunny.png" alt="" class="pixel-sprite w-5 h-5 animate-bounce-slow" />
          <p>&copy; {new Date().getFullYear()} Ian Hogers. Gets stuff done since forever.</p>
        </div>
        <div class="flex items-center gap-3 text-xs">
          <a href="/credits" class="text-gray-500 hover:text-gray-300 no-underline">credits</a>
          <span class="text-gray-700">Â·</span>
          <a href="/dev/rss.xml" class="text-gray-500 hover:text-gray-300 no-underline">rss</a>
        </div>
      </div>
    </footer>

    <!-- Floating decorative elements -->
    {side === 'personal' && (
      <div class="fixed bottom-4 right-4 opacity-30 pointer-events-none hidden lg:block">
        <img src="/assets/pixel-art/decorative/carrot-small.png" alt="" class="pixel-sprite w-10 h-auto animate-float" />
      </div>
    )}
    {side === 'dev' && (
      <div class="fixed bottom-4 right-4 opacity-20 pointer-events-none hidden lg:block">
        <img src="/assets/pixel-art/game-assets/wow_blue.png" alt="" class="pixel-sprite w-10 h-10 animate-float-slow" />
      </div>
    )}
    <!-- Spritesheet cursor -->
    <script src="/cursor.js" is:inline></script>
  </body>
</html>

<style is:global>
  @import '../styles/global.css';
</style>
